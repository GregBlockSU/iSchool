function send_contact_request(userid,contactid,contactname,pagenum,current_userid,personal_message){Ext.Ajax.request({url:M.cfg.wwwroot+'/local/utilities/contacts/action.php',method:'GET',success:function(response){if(response['responseText'].indexOf('success')>=0){Ext.Msg.alert('Success','Your request has been sent to '+contactname+' successfully!');reload_contact(pagenum,current_userid);}
else{Ext.Msg.alert('Error','Your request with '+contactname+' was unsuccessful.');}},failure:function(){Ext.Msg.alert('Error','An error occurred on your request with '+contactname+'.  Please try again. If problems persist, please contact us.')},params:{userid:userid,contactid:contactid,action:'add',msg:personal_message}});}
function contact_add_req(userid,contactid,contactname,pagenum,current_userid){if($('[ng-app="onlineCampusApp"]').length>0){send_contact_request(userid,contactid,contactname,pagenum,current_userid,'');}else{Ext.MessageBox.show({title:'Add '+contactname+' as contact',msg:'Add a personal message: (optional)',width:300,buttons:Ext.MessageBox.OKCANCEL,multiline:true,fn:function(btn,text){if(btn=='ok'){send_contact_request(userid,contactid,contactname,pagenum,current_userid,text);}}});Ext.MessageBox.getDialog().getEl().setStyle('z-index','8000000');}};function removeContactNotification(elem){mainNode=elem.parentNode.parentNode.parentNode.parentNode.parentNode;if(Object.prototype.toString.call(mainNode)=='[object HTMLLIElement]')
{mainNode.parentNode.removeChild(mainNode);}
else{mainNode=elem.parentNode.parentNode.parentNode;mainNode.parentNode.removeChild(mainNode);}}
function contact_respond_req(elem,reqid,userid,contactid,contactname){Ext.MessageBox.show({title:'New Contact Request',msg:'You received a contact request from '+contactname+'.  Do you want to confirm and add them to your contact list?',width:300,buttons:Ext.MessageBox.YESNOCANCEL,fn:function(btn,text){if(btn=='yes'){Ext.Ajax.request({url:M.cfg.wwwroot+'/local/utilities/contacts/action.php',method:'GET',success:function(response,options){if(response['responseText'].indexOf('success')>=0){removeContactNotification(elem);Ext.Msg.alert('Success','You have successfully confirmed the contact request from '+contactname+'.');window.location.reload();}
else{Ext.Msg.alert('Error','Your confirmation to the contact request from '+contactname+' was unsuccessful.');}},failure:function(){Ext.Msg.alert('Error','There was an error while confirming the request from '+contactname+'.  Please try again. If problems persist, please contact us.')},params:{reqid:reqid,userid:userid,contactid:contactid,action:'confirm'}});}}});};function ignore_contact_req(elem,reqid,userid,contactid,contactname){Ext.MessageBox.show({title:'New Contact Request',msg:'You received a contact request from '+contactname+'.  Do you want to ignore and remove this request?',width:300,buttons:Ext.MessageBox.YESNOCANCEL,fn:function(btn,text){if(btn=='yes'){Ext.Ajax.request({url:M.cfg.wwwroot+'/local/utilities/contacts/action.php',method:'GET',success:function(response,options){if(response['responseText'].indexOf('success')>=0){removeContactNotification(elem);Ext.Msg.alert('Success','You have successfully denied the contact request from '+contactname+'.');}
else{Ext.Msg.alert('Error','Your denial to the contact request from '+contactname+' was unsuccessful.');}},failure:function(){Ext.Msg.alert('Error','There was an error while denying the request from '+contactname+'.  Please try again. If problems persist, please contact us.')},params:{reqid:reqid,userid:userid,contactid:contactid,action:'ignore'}});}}});};function contact_remove(userid,contactid,contactname,pagenum,current_userid){Ext.MessageBox.show({title:'Delete Contact',msg:'Are you sure you want to remove '+contactname+' from your contact list?',width:300,buttons:Ext.MessageBox.YESNO,fn:function(btn,text){if(btn=='yes'){Ext.Ajax.request({url:M.cfg.wwwroot+'/local/utilities/contacts/action.php',method:'GET',success:function(response,options){reload_contact(pagenum,current_userid);},failure:function(){Ext.Msg.alert('Error','There was an error while removing '+contactname+' from your contact list.  Please try again. If problems persist, please contact us.')},params:{userid:userid,contactid:contactid,action:'remove'}});}}});}
function reload_contact(pagenum,current_userid){if(pagenum!=0){var url=window.location.pathname;var filename=url.substring(url.lastIndexOf('/')+1);window.location=M.cfg.wwwroot+'/my/'+filename+'?id='+current_userid+'&page='+pagenum;}else{window.location.reload();}}